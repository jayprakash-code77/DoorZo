<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>MapLibre Style Switcher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css" rel="stylesheet" />

</head>

<body>

  <!-- Toggle switch -->
  <div class="style-switcher">
    <span>🌍</span>
    <label class="switch">
      <input type="checkbox" id="styleToggle">
      <span class="slider"></span>
    </label>
    <span>🛰️</span>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
  <script>
    const styles = {
      normal: {
        version: 8,
        sources: {
          osm: {
            type: 'raster',
            tiles: ['https://a.tile.openstreetmap.org/{z}/{x}/{y}.png'],
            tileSize: 256,
            attribution: '&copy; OpenStreetMap contributors'
          }
        },
        layers: [{
          id: 'osm',
          type: 'raster',
          source: 'osm'
        }]
      },
      satellite: {
        version: 8,
        sources: {
          esri: {
            type: 'raster',
            tiles: [
              'https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'
            ],
            tileSize: 256,
            attribution: '© Esri, Maxar, Earthstar Geographics, and the GIS user community'
          },
          labels: {
            type: 'raster',
            tiles: [
              'https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}'
            ],
            tileSize: 256,
            attribution: 'Labels © Esri'
          }
        },
        layers: [
          {
            id: 'satellite',
            type: 'raster',
            source: 'esri'
          },
          {
            id: 'labels',
            type: 'raster',
            source: 'labels'
          }
        ]
      }

    };

    const map = new maplibregl.Map({
      container: 'map',
      style: styles.normal,
      center: [77.2090, 28.6139], // New Delhi
      zoom: 12
    });

    map.addControl(new maplibregl.NavigationControl());

    const marker = new maplibregl.Marker({ color: 'red' })
      .setLngLat([77.2090, 28.6139])
      .setPopup(new maplibregl.Popup().setText("This is New Delhi!"))
      .addTo(map);

    document.getElementById('styleToggle').addEventListener('change', function () {
      const newStyle = this.checked ? styles.satellite : styles.normal;
      const center = map.getCenter();
      const zoom = map.getZoom();

      map.setStyle(newStyle);
      map.once('style.load', () => {
        map.setCenter(center);
        map.setZoom(zoom);
        marker.addTo(map); // Add marker again
      });
    });
  </script>

</body>

</html>